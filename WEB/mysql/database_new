CREATE TABLE USERS(
     username VARCHAR(25) UNIQUE NOT NULL,
	 password VARCHAR(25) NOT NULL,
	 profile ENUM('civilian','administrator','volunteer') NOT NULL,
	 PRIMARY KEY(username)
);


CREATE TABLE CIVILIAN (
    civilian_user VARCHAR(25),
    full_name VARCHAR(25) NOT NULL,
    phone CHAR(10) NOT NULL,
    latitude DECIMAL(10, 8),
    longitude DECIMAL(11, 8),
    PRIMARY KEY(civilian_user),
	 CONSTRAINT CIVILIANUSER FOREIGN KEY(civilian_user) REFERENCES USERS(username)
	 ON DELETE CASCADE ON UPDATE CASCADE
);


CREATE TABLE CATEGORIES (
    category_id INT,
    category_name VARCHAR(255),
    PRIMARY KEY(category_id)
) ;


CREATE TABLE PRODUCTS (
    product_id INT NOT NULL,
    category_id INT NOT NULL,
    item VARCHAR(25) NOT NULL,
    description LONGTEXT NOT NULL,
    available INT NOT NULL,
    PRIMARY KEY(product_id),
    FOREIGN KEY (category_id) REFERENCES CATEGORIES(category_id)
        ON DELETE CASCADE ON UPDATE CASCADE
) AUTO_INCREMENT=1000;


CREATE TABLE PRODUCT_DETAILS (
    product_id INT NOT NULL,
    detail_name VARCHAR(255),
    detail_value VARCHAR(255),
    FOREIGN KEY (product_id) REFERENCES PRODUCTS(product_id)
        ON DELETE CASCADE ON UPDATE CASCADE
);


CREATE TABLE INQUIRY (
    inquiry_id INT AUTO_INCREMENT,
    inquiry_status ENUM('approved', 'finished', 'disapproved', 'cancelled') NOT NULL,
    inquiry_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    inquiry_user VARCHAR(25) NOT NULL,
    inquiry_product INT NOT NULL,
    inquiry_quantity INT NOT NULL,
    PRIMARY KEY(inquiry_id, inquiry_user),
	 CONSTRAINT INQUIRYUSER FOREIGN KEY(inquiry_user) REFERENCES CIVILIAN(civilian_user)
	 ON DELETE CASCADE ON UPDATE CASCADE,
	 CONSTRAINT PRODUCT_INQUIRY FOREIGN KEY(inquiry_product) REFERENCES PRODUCTS(product_id)
	 ON DELETE CASCADE ON UPDATE CASCADE
) AUTO_INCREMENT=1;


CREATE TABLE OFFERS (
    offer_id INT AUTO_INCREMENT,
    offer_status ENUM('approved', 'finished', 'disapproved', 'cancelled') NOT NULL,
    offer_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    offer_user VARCHAR(25) NOT NULL,
    offer_product INT NOT NULL,
    offer_quantity INT NOT NULL,
    PRIMARY KEY(offer_id, offer_user),
	CONSTRAINT OFFERUSER FOREIGN KEY(offer_user) REFERENCES CIVILIAN(civilian_user)
	ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT PRODUCT_OFFER FOREIGN KEY(offer_product) REFERENCES PRODUCTS(product_id)
	ON DELETE CASCADE ON UPDATE CASCADE
) AUTO_INCREMENT=2000;


CREATE TABLE VOLUNTEER (
    volunteer_user VARCHAR(25),
    vehicle VARCHAR(25) UNIQUE,
    PRIMARY KEY(volunteer_user),
	CONSTRAINT VOLUNTEERUSER FOREIGN KEY(volunteer_user) REFERENCES USERS(username)
	ON DELETE CASCADE ON UPDATE CASCADE
);


CREATE TABLE VEHICLE (
    vehicle_id VARCHAR(25) NOT NULL,
	vehicle_inquiry_id INT(9) NOT NULL,
	vehicle_offer_id INT(9) NOT NULL,
	latitude_vehicle DECIMAL(10, 8),
    longitude_vehicle DECIMAL(11, 8),
	PRIMARY KEY(vehicle_id),
	CONSTRAINT VEHICLE FOREIGN KEY(vehicle_id) REFERENCES VOLUNTEER(vehicle)
	ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT VOLUNTEERINQUIRY FOREIGN KEY(vehicle_inquiry_id) REFERENCES INQUIRY(inquiry_id)
	ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT VOLUNTEEROFFER FOREIGN KEY(vehicle_offer_id) REFERENCES OFFERS(offer_id)
	ON DELETE CASCADE ON UPDATE CASCADE
);


CREATE TABLE ADMIN (
    admin_user VARCHAR(25) UNIQUE NOT NULL,
    latitude_vehicle DECIMAL(10, 8),
    longitude_vehicle DECIMAL(11, 8),
    PRIMARY KEY(admin_user),
	CONSTRAINT ADMINUSER FOREIGN KEY(admin_user) REFERENCES USERS(username)
	ON DELETE CASCADE ON UPDATE CASCADE
);


CREATE TABLE ANNOUNCEMENTS (
    announce_id INT NOT NULL UNIQUE AUTO_INCREMENT,
    announce_product INT NOT NULL,
    announce_quantity INT NOT NULL,
    PRIMARY KEY(announce_id),
	CONSTRAINT ANNOUNCE_OFFER FOREIGN KEY(announce_product) REFERENCES products(product_id)
	ON DELETE CASCADE ON UPDATE CASCADE
) AUTO_INCREMENT=3000;

insert into users values("admin","admin","administrator")

insert into admin values("admin", 38.264100945783525, 21.754283452141237);